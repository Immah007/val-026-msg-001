<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>For Karyn</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: 'Cormorant Garamond', 'Inter', -apple-system, BlinkMacSystemFont, serif;
            background: #fcf4ef;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            transition: background 1.4s ease;
            position: relative;
            overflow-x: hidden;
            padding: 0 0;
            width: 100%;
        }

        .touch-hint {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            background: rgba(255, 225, 235, 0.85);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            padding: 12px 18px;
            text-align: center;
            font-size: 1.1rem;
            font-weight: 600;
            color: #632c3b;
            border-bottom: 2px solid rgba(255, 255, 255, 0.8);
            z-index: 10001;
            letter-spacing: 1px;
            box-shadow: 0 6px 20px rgba(255, 160, 180, 0.3);
            font-family: 'Cormorant Garamond', serif;
            border-bottom-left-radius: 30px;
            border-bottom-right-radius: 30px;
            transition: 0.3s;
        }

        .touch-hint span {
            display: inline-block;
            animation: pulseHint 2s infinite;
        }

        @keyframes pulseHint {
            0%,100% { transform: scale(1); text-shadow: 0 0 0 #ff8da1; }
            50% { transform: scale(1.05); text-shadow: 0 0 10px #ff4d6d; }
        }

        #heartCanvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 5000;
        }

        .fade-layer {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: black;
            opacity: 0;
            pointer-events: none;
            z-index: 10000;
            transition: opacity 3.2s cubic-bezier(0.23, 1, 0.32, 1);
            visibility: hidden;
        }

        .fade-active {
            opacity: 1;
            visibility: visible;
        }

        .quit-overlay {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.9);
            background: rgba(20, 20, 20, 0.96);
            backdrop-filter: blur(24px);
            -webkit-backdrop-filter: blur(24px);
            border: 1px solid rgba(255, 180, 190, 0.5);
            border-radius: 48px 16px 48px 16px;
            padding: 36px 28px;
            max-width: 320px;
            width: 85%;
            color: white;
            text-align: center;
            z-index: 12000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.4s ease, transform 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
            box-shadow: 0 0 80px rgba(255, 60, 100, 0.8);
            border: 1px solid rgba(255, 140, 160, 0.9);
        }

        .quit-visible {
            opacity: 1;
            visibility: visible;
            transform: translate(-50%, -50%) scale(1);
        }

        .quit-overlay h3 {
            font-size: 2.4rem;
            margin-bottom: 16px;
            font-weight: 700;
            background: linear-gradient(145deg, #ffe0e7, #ffb6c1);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .quit-overlay p {
            font-size: 1.4rem;
            margin-bottom: 28px;
            color: #ffd9e0;
            font-style: italic;
        }

        .quit-btn {
            background: white;
            border: none;
            padding: 14px 36px;
            border-radius: 60px;
            font-size: 1.3rem;
            font-weight: 700;
            color: #1a1a1a;
            border: 2px solid #ff8caa;
            cursor: pointer;
            transition: 0.2s;
            font-family: 'Cormorant Garamond', serif;
            box-shadow: 0 6px 0 #b35f73;
        }

        .quit-btn:active {
            transform: translateY(6px);
            box-shadow: 0 2px 0 #b35f73;
            background: #ffe0e7;
        }

        .trap-overlay {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.9);
            background: rgba(30, 20, 30, 0.98);
            backdrop-filter: blur(24px);
            -webkit-backdrop-filter: blur(24px);
            border: 1px solid rgba(255, 120, 160, 0.7);
            border-radius: 48px 16px 48px 16px;
            padding: 40px 28px;
            max-width: 340px;
            width: 85%;
            color: white;
            text-align: center;
            z-index: 13000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.4s ease, transform 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
            box-shadow: 0 0 100px rgba(255, 40, 120, 0.9);
            border: 2px solid #ff99bb;
        }

        .trap-visible {
            opacity: 1;
            visibility: visible;
            transform: translate(-50%, -50%) scale(1);
        }

        .trap-overlay h3 {
            font-size: 2.2rem;
            margin-bottom: 20px;
            font-weight: 700;
            background: linear-gradient(145deg, #ffe4ec, #ffb0c3);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .trap-overlay p {
            font-size: 1.5rem;
            margin-bottom: 16px;
            color: #ffe0e8;
        }

        .intro {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(250, 241, 235, 0.98);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 3000;
            padding: 20px;
            transition: opacity 0.9s cubic-bezier(0.23, 1, 0.32, 1), visibility 0.9s;
            opacity: 1;
            visibility: visible;
        }

        .intro-card {
            max-width: 360px;
            width: 100%;
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(24px);
            padding: 42px 24px;
            border-radius: 56px 20px 56px 20px;
            border: 1px solid rgba(255, 255, 255, 0.8);
            box-shadow: 0 30px 50px -20px rgba(80, 40, 60, 0.2);
            text-align: center;
        }

        .intro-name {
            font-size: 2.5rem;
            font-weight: 600;
            color: #2e1c22;
            margin-bottom: 8px;
            font-family: 'Cormorant Garamond', serif;
        }

        .intro-name span {
            color: #b84c5c;
            border-bottom: 2px dashed #d698a8;
            padding-bottom: 4px;
        }

        .intro-line {
            font-size: 1.3rem;
            color: #4f353b;
            margin: 20px 0 16px;
            font-style: italic;
            line-height: 1.5;
        }

        .intro-question {
            font-size: 1.7rem;
            font-weight: 500;
            color: #2a1a1e;
            margin: 24px 0 32px;
            letter-spacing: 1.5px;
        }

        .btn-row {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 24px;
            margin-top: 12px;
            flex-wrap: wrap;
        }

        .btn {
            border: none;
            background: rgba(230, 215, 210, 0.7);
            backdrop-filter: blur(4px);
            padding: 14px 32px;
            border-radius: 60px;
            font-size: 1.4rem;
            font-weight: 500;
            color: #281c1e;
            border: 1px solid rgba(255, 255, 255, 0.7);
            cursor: pointer;
            min-width: 120px;
            font-family: 'Cormorant Garamond', serif;
            box-shadow: 0 6px 12px rgba(0,0,0,0.02);
            transition: all 0.25s;
            touch-action: manipulation;
        }

        .btn-no {
            background: rgba(210, 195, 190, 0.7);
        }

        .mystic-realm {
            display: none;
            width: 100%;
            opacity: 0;
            transition: opacity 1.2s ease;
            position: relative;
            z-index: 100;
            margin-top: 65px;
            margin-bottom: 20px;
        }

        .realm-visible {
            display: block;
            opacity: 1;
        }

        .enchanted-bg {
            background: radial-gradient(circle at 40% 30%, #ffe6ef, #ffdae6);
        }

        .velvet-locket {
            width: 100%;
            max-width: 315px;
            margin: 0 auto;
            background: rgba(255, 247, 250, 0.75);
            backdrop-filter: blur(28px);
            -webkit-backdrop-filter: blur(28px);
            border-radius: 52px 24px 52px 24px;
            border: 1.5px solid rgba(255, 255, 255, 0.9);
            box-shadow: 0 20px 0 rgba(220, 160, 180, 0.5), 0 30px 60px rgba(150, 90, 110, 0.25);
            padding: 30px 20px;
            transition: 0.3s;
        }

        .realm-header {
            display: flex;
            align-items: baseline;
            justify-content: space-between;
            border-bottom: 2px dotted rgba(190, 130, 150, 0.4);
            padding-bottom: 14px;
            margin-bottom: 16px;
        }

        .realm-header h2 {
            font-size: 2.2rem;
            font-weight: 700;
            background: linear-gradient(145deg, #b84c5c, #cf7a8b);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            font-family: 'Cormorant Garamond', serif;
        }

        .secret-gallery {
            display: flex;
            flex-direction: column;
            gap: 16px;
            margin: 22px 0;
        }

        .secret-card {
            background: rgba(255, 235, 245, 0.8);
            backdrop-filter: blur(8px);
            border-radius: 36px 16px 36px 16px;
            padding: 14px 16px;
            border: 2px solid white;
            box-shadow: 0 7px 0 #e3aebc, 0 12px 28px #fbc1d0;
            display: flex;
            align-items: center;
            gap: 12px;
            cursor: pointer;
            transition: all 0.18s;
            min-height: 80px;
            touch-action: manipulation;
        }

        .secret-card:active {
            transform: translateY(5px);
            box-shadow: 0 2px 0 #ca97a5, 0 20px 35px #fbb0c0;
        }

        .secret-emoji {
            font-size: 2.4rem;
            filter: drop-shadow(0 6px 8px #ffa7b9);
        }

        .secret-message {
            flex: 1;
            font-size: 1.1rem;
            font-weight: 600;
            color: #562b38;
            font-family: 'Cormorant Garamond', serif;
            line-height: 1.35;
            word-break: break-word;
        }

        .pearl-meter {
            background: rgba(255, 237, 245, 0.8);
            border-radius: 100px;
            padding: 18px 20px;
            border: 2px dashed #ffb0c3;
            margin: 20px 0;
        }

        .meter-header {
            display: flex;
            justify-content: space-between;
            font-size: 1.25rem;
            font-weight: 600;
            color: #6d3343;
            margin-bottom: 10px;
            font-family: 'Cormorant Garamond', serif;
        }

        .love-river {
            height: 38px;
            background: rgba(255, 210, 220, 0.6);
            border-radius: 40px;
            border: 2px solid white;
            overflow: hidden;
            cursor: pointer;
            box-shadow: inset 0 2px 10px #d99caa;
            touch-action: manipulation;
        }

        .river-fill {
            height: 100%;
            width: 60%;
            background: linear-gradient(90deg, #ffa1b7, #ff708e, #ffa1b7);
            background-size: 200% 100%;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 14px;
            color: white;
            font-weight: 800;
            text-shadow: 0 0 6px #4f1e2b;
            transition: width 0.5s cubic-bezier(0.23, 1, 0.32, 1);
            animation: shimmer 4s infinite;
            font-size: 1rem;
        }

        @keyframes shimmer {
            0% { background-position: 0% 50%; }
            100% { background-position: 200% 50%; }
        }

        .altar {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 25px 0 18px;
            flex-wrap: wrap;
        }

        .altar-btn {
            border: none;
            background: linear-gradient(145deg, #ffe7f0, #ffd9e8);
            padding: 12px 28px;
            border-radius: 120px;
            font-size: 1.5rem;
            font-weight: 600;
            color: #542c38;
            box-shadow: 0 10px 0 #c28b99, 0 12px 40px #fbaec2;
            border: 1.5px solid white;
            transition: 0.06s;
            font-family: 'Cormorant Garamond', serif;
            touch-action: manipulation;
        }

        .altar-btn:active {
            transform: translateY(6px);
            box-shadow: 0 4px 0 #ad7582, 0 18px 45px #f79eb1;
        }

        .destiny-silk {
            text-align: center;
            font-size: 1.25rem;
            background: rgba(255, 250, 245, 0.9);
            backdrop-filter: blur(12px);
            padding: 16px 16px;
            border-radius: 80px;
            border: 1px solid #ffcedb;
            color: #6a3345;
            font-weight: 600;
            margin-top: 18px;
            min-height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Cormorant Garamond', serif;
            box-shadow: 0 6px 0 #eac2cb;
            word-break: break-word;
        }

        @media (min-width: 330px) and (max-width: 410px) {
            .intro-card { padding: 32px 18px; }
            .btn { padding: 12px 22px; min-width: 110px; font-size: 1.3rem; }
            .velvet-locket { padding: 22px 16px; }
            .realm-header h2 { font-size: 2rem; }
            .secret-message { font-size: 1.05rem; }
            .touch-hint { font-size: 0.95rem; padding: 10px 12px; }
            .quit-overlay { padding: 28px 20px; }
            .trap-overlay { padding: 32px 20px; }
        }

        @media (max-width: 340px) {
            .btn { padding: 10px 18px; min-width: 100px; font-size: 1.2rem; }
        }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@500;600;700&family=Inter:wght@300;400;500&display=swap" rel="stylesheet">
</head>
<body id="bodyRoot">
    <div class="touch-hint">
        <span>üíã touch anything ‚Äî magic happens üíã</span>
    </div>

    <div id="fadeLayer" class="fade-layer"></div>

    <div id="quitOverlay" class="quit-overlay">
        <h3>üòà quit?</h3>
        <p>are you sure?</p>
        <button id="quitBtn" class="quit-btn">quit üíîü•∫</button>
    </div>

    <div id="trapOverlay" class="trap-overlay">
        <h3>üòÇ HAHA!</h3>
        <p>you're trapped.<br>there is no quitting!</p>
        <p style="font-size: 2rem; margin-top: 8px;">üíòüíòüíò</p>
    </div>

    <canvas id="heartCanvas"></canvas>

    <div id="introOverlay" class="intro">
        <div class="intro-card">
            <div class="intro-name">for <span>Karyn</span></div>
            <div class="intro-line">you are the most beautiful, amazing, cute and awesome girl in aaaaaaaalllll the worldü•∞ü•∞‚ù§Ô∏è.</div>
            <div class="intro-question">will you be my Valentine?ü•∫</div>
            <div class="btn-row">
                <button id="yesBtnIntro" class="btn btn-yes">yes üíï</button>
                <button id="noBtnIntro" class="btn btn-no">no üå™Ô∏è</button>
            </div>
        </div>
    </div>

    <div id="mysticRealm" class="mystic-realm">
        <div class="velvet-locket">
            <div class="realm-header">
                <h2>ü©∑for Karyn onlyü•∞ü©∑</h2>
            </div>

            <div class="secret-gallery">
                <div class="secret-card" id="secret1">
                    <div class="secret-message" id="msg1">
                        ‚ùì tap to unveil üí≠
                    </div>
                </div>
                <div class="secret-card" id="secret2">
                    <div class="secret-message" id="msg2">
                        ‚ùì tap to unveil üíå
                    </div>
                </div>
                <div class="secret-card" id="secret3">
                    <div class="secret-message" id="msg3">
                        ‚ùì tap to unveil ‚ú®
                    </div>
                </div>
            </div>

            <div id="secretHeaderZone" style="text-align: center; margin-bottom: 5px; cursor: pointer; padding: 8px; border-radius: 60px; background: rgba(255,220,240,0.3);">
                <span style="font-size: 1.3rem; color: #9e4a63;">‚ú® secret spot ‚ú®</span>
            </div>

            <div class="pearl-meter">
                <div class="meter-header">
                    <span>heartbeat üíì</span>
                    <span id="lovePercent">64%</span>
                </div>
                <div class="love-river" id="loveRiver">
                    <div class="river-fill" id="riverFill" style="width: 64%;">üíñ</div>
                </div>
                <p style="color: #a14f64; font-size: 0.8rem; margin-top: 10px;">‚ú® tap the river ‚Äî send a shiver ‚ú®</p>
            </div>

            <div class="altar">
                <button id="mysticYesBtn" class="altar-btn">yes üíû</button>
                <button id="mysticNoBtn" class="altar-btn" style="background: #ffdae7;">no üå™Ô∏è</button>
            </div>

            <div id="destinySilk" class="destiny-silk">
                you're the only yes I know. üíò
            </div>
            <p style="color: #b15e74; text-align: center; margin-top: 16px; font-size: 0.75rem;">üíã every touch ‚Äî hearts appear üíã</p>
        </div>
    </div>

    <script>
        (function(){
            const baseMessages = [
    "we listen and we don‚Äôt judge‚Ä¶ but you‚Äôre actually my favorite person fr ü•π",
    "ati why are you always on my mind like rent is due üò≠",
    "your laugh? yeah that one. it does things.",
    "you‚Äôre my soft spot and i‚Äôm not even fighting it",
    "be serious‚Ä¶ why do you vibe that good üåßÔ∏èüåπ",
    "i re-read your texts like i‚Äôm revising for finals üò≠üì±",
    "you‚Äôre actually so unfairly attractive",
    "i‚Äôd share my last slice of nyama choma with you. think about that.",
    "it‚Äôs the way you‚Äôre just‚Ä¶ you. elite behavior.",
    "i act nonchalant but i‚Äôm actually gone.",
    "you say one thing and my whole mood improves",
    "you feel like getting home after tao traffic ü´†",
    "every love song? yeah it‚Äôs giving you.",
    "you‚Äôre my favorite distraction and i blame you fully",
    "i like you bad. like‚Ä¶ bad bad.",
    "in every universe it‚Äôs still you. hakuna debate.",
    "why did you come and destabilize my entire life like this",
    "you‚Äôre actually poetry but in a lowkey way",
    "i‚Äôd still pick you even if WiFi is slow",
    "you make my chest feel warm warm",
    "you‚Äôre giving ringoz when i was in class 2üòâ",
    "even silence with you is not awkward. that‚Äôs crazy.",
    "my heart just did that thing again. you know.",
    "it‚Äôs you. always you. don‚Äôt argue.üòë",
    "i think about you more than i admit. embarrassing.",
    "you‚Äôre the first thought when i wake up. unfortunately.",
    "your name hits different",
    "i‚Äôd wait. lakini don‚Äôt test me üò≠",
    "you make me believe in soft life",
    "unforgettable? you‚Äôre actually ridiculous.",
    "so when are you removing this spell or‚Ä¶?",
    "my favorite view is you. no cap.",
    "you‚Äôre the type i prayed for lowkey",
    "let‚Äôs disappear kidogo together",
    "your smile? illegal.",
    "you‚Äôre the pink sky after heavy rain type vibe",
    "iam all yours....",
    "you‚Äôre the answer even when i don‚Äôt know the question",
    "you feel like sunday afternoon with good tea",
    "my heart has already chosen. relax.",
    "you‚Äôre the kind of person people gatekeep",
    "time moves different when i‚Äôm with you",
    "you text and suddenly life is manageable",
    "i‚Äôm choosing you. again. always. willingly.",
    "you make everything softer. even me.",
    "you‚Äôre in my system like strong kahawa",
    "you feel familiar but in a soulmate way",
    "you‚Äôre the good kind of stress üò≠",
    "you always find your way back to me. suspicious.",
    "you give me butterflies and i hate that i love it",
    "it‚Äôs giving fate. heavy on destiny.",
    "you‚Äôre the one i didn‚Äôt know i was waiting for fr"
];


            const nicknames = ["babe", "kamummie", "baby", "my love", "sweetheart", "beautiful", "darling", "pretty", "sunshine", "love"];

            function getOrganicMessage() {
                let message = baseMessages[Math.floor(Math.random() * baseMessages.length)];
                if (Math.random() < 0.7) {
                    const nickname = nicknames[Math.floor(Math.random() * nicknames.length)];
                    const words = message.split(' ');
                    if (words.length > 2) {
                        const insertPos = Math.floor(Math.random() * (words.length - 1)) + 1;
                        words.splice(insertPos, 0, nickname);
                        message = words.join(' ');
                    } else {
                        message = words[0] + ' ' + nickname + ' ' + words.slice(1).join(' ');
                    }
                }
                if (Math.random() < 0.4) {
                    message += ' ' + ['üíï', 'üíó', 'ü©∑', 'üíñ', 'üíò', 'üíì', '‚ú®', 'üåπ', 'üå∏', 'ü¶ã'][Math.floor(Math.random() * 10)];
                }
                return message;
            }

            const canvas = document.getElementById('heartCanvas');
            const ctx = canvas.getContext('2d');
            let w, h, hearts = [];

            function resize() {
                w = window.innerWidth;
                h = window.innerHeight;
                canvas.width = w;
                canvas.height = h;
            }
            resize();
            window.addEventListener('resize', resize);

            function burstHearts(x, y, count = 16) {
                for (let i=0; i<count; i++) {
                    hearts.push({
                        x, y,
                        vx: (Math.random()-0.5)*5.5,
                        vy: (Math.random()-0.7)*6 - 2,
                        size: Math.floor(Math.random()*12)+7,
                        life: 0.95,
                        alpha: 0.8,
                        color: `rgba(255, ${Math.floor(140+Math.random()*80)}, ${Math.floor(130+Math.random()*70)}, 0.8)`
                    });
                }
            }

            function burstFromElement(el) {
                if (!el) return;
                const rect = el.getBoundingClientRect();
                burstHearts(rect.left+rect.width/2, rect.top+rect.height/2, 20);
            }

            function animateHearts() {
                ctx.clearRect(0,0,w,h);
                for (let i=hearts.length-1; i>=0; i--) {
                    let hrt = hearts[i];
                    ctx.save();
                    ctx.translate(hrt.x, hrt.y);
                    ctx.globalAlpha = hrt.alpha * hrt.life;
                    ctx.font = `${hrt.size}px 'Inter', sans-serif`;
                    ctx.fillStyle = hrt.color;
                    ctx.fillText('‚ù§Ô∏è', 0, 0);
                    ctx.restore();
                    hrt.x += hrt.vx;
                    hrt.y += hrt.vy;
                    hrt.vy += 0.1;
                    hrt.vx *= 0.99;
                    hrt.vy *= 0.99;
                    hrt.life -= 0.005;
                    if (hrt.life <= 0.01 || hrt.y > h+30) hearts.splice(i,1);
                }
                requestAnimationFrame(animateHearts);
            }
            animateHearts();

            const intro = document.getElementById('introOverlay');
            const mysticRealm = document.getElementById('mysticRealm');
            const bodyRoot = document.getElementById('bodyRoot');
            const yesIntro = document.getElementById('yesBtnIntro');
            const noIntro = document.getElementById('noBtnIntro');
            const fadeLayer = document.getElementById('fadeLayer');
            const quitOverlay = document.getElementById('quitOverlay');
            const trapOverlay = document.getElementById('trapOverlay');
            const quitBtn = document.getElementById('quitBtn');

            let autoTransitionTimer = null;
            let trapTimer = null;

            function playDramaticSound() {
                try {
                    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
                    const oscillator = audioCtx.createOscillator();
                    const gainNode = audioCtx.createGain();
                    oscillator.type = 'sine';
                    oscillator.frequency.setValueAtTime(110, audioCtx.currentTime);
                    oscillator.frequency.exponentialRampToValue(45, audioCtx.currentTime + 2.8);
                    gainNode.gain.setValueAtTime(0.4, audioCtx.currentTime);
                    gainNode.gain.exponentialRampToValue(0.001, audioCtx.currentTime + 3);
                    oscillator.connect(gainNode);
                    gainNode.connect(audioCtx.destination);
                    oscillator.start();
                    oscillator.stop(audioCtx.currentTime + 3.1);
                } catch(e) {}
            }

            function clearTimers() {
                if (autoTransitionTimer) clearTimeout(autoTransitionTimer);
                if (trapTimer) clearTimeout(trapTimer);
            }

            yesIntro.addEventListener('click', function(e) {
                e.stopPropagation();
                clearTimers();
                unveilMysticRealm(yesIntro, false);
            });

            noIntro.addEventListener('click', function(e) {
                e.stopPropagation();
                clearTimers();
                
                noIntro.innerText = 'yes üíò';
                noIntro.style.background = 'rgba(225, 200, 200, 0.8)';
                noIntro.style.color = '#2c1c1e';
                noIntro.style.border = '1px solid #ffb8c9';
                
                burstFromElement(noIntro);
                
                setTimeout(() => {
                    fadeLayer.classList.add('fade-active');
                    playDramaticSound();
                    
                    setTimeout(() => {
                        fadeLayer.classList.remove('fade-active');
                        noIntro.innerText = 'no üå™Ô∏è';
                        noIntro.style.background = 'rgba(210, 195, 190, 0.7)';
                        noIntro.style.color = '#281c1e';
                        
                        quitOverlay.classList.add('quit-visible');
                        burstFromElement(quitOverlay);
                        
                        autoTransitionTimer = setTimeout(() => {
                            if (quitOverlay.classList.contains('quit-visible')) {
                                quitOverlay.classList.remove('quit-visible');
                                showTrapAndTransition();
                            }
                        }, 5000);
                        
                    }, 3200);
                }, 3000);
            });

            function showTrapAndTransition() {
                trapOverlay.classList.add('trap-visible');
                burstFromElement(trapOverlay);
                
                trapTimer = setTimeout(() => {
                    trapOverlay.classList.remove('trap-visible');
                    unveilMysticRealm(noIntro, true);
                }, 2000);
            }

            quitBtn.addEventListener('click', function() {
                burstFromElement(quitBtn);
                clearTimeout(autoTransitionTimer);
                quitOverlay.classList.remove('quit-visible');
                showTrapAndTransition();
            });

            function unveilMysticRealm(clickedBtn, fromNo = false) {
                burstFromElement(clickedBtn);
                bodyRoot.classList.add('enchanted-bg');
                intro.style.opacity = '0';
                intro.style.visibility = 'hidden';
                mysticRealm.style.display = 'block';
                setTimeout(() => {
                    mysticRealm.classList.add('realm-visible');
                }, 60);
                lovePercent = 64;
                updateLoveMeter();

                if (fromNo) {
                    destinySilk.innerText = 'üòÇ you said no, but your heart said yes üíã‚ú®';
                }
                
                randomizeCardMessages();
            }

            const msg1 = document.getElementById('msg1');
            const msg2 = document.getElementById('msg2');
            const msg3 = document.getElementById('msg3');
            const secret1 = document.getElementById('secret1');
            const secret2 = document.getElementById('secret2');
            const secret3 = document.getElementById('secret3');
            const secretHeader = document.getElementById('secretHeaderZone');

            function randomizeCardMessages() {
                msg1.innerText = getOrganicMessage();
                msg2.innerText = getOrganicMessage();
                msg3.innerText = getOrganicMessage();
            }

            secret1.addEventListener('click', function() {
                msg1.innerText = getOrganicMessage();
                burstFromElement(secret1);
                addLove(4, secret1);
                destinySilk.innerText = 'üíå secret for you üíå';
            });

            secret2.addEventListener('click', function() {
                msg2.innerText = getOrganicMessage();
                burstFromElement(secret2);
                addLove(4, secret2);
                destinySilk.innerText = 'üå∏ another whisper üå∏';
            });

            secret3.addEventListener('click', function() {
                msg3.innerText = getOrganicMessage();
                burstFromElement(secret3);
                addLove(4, secret3);
                destinySilk.innerText = '‚ú® magic spoken ‚ú®';
            });

            secretHeader.addEventListener('click', function() {
                burstFromElement(secretHeader);
                addLove(10, secretHeader);
                destinySilk.innerText = '‚ú® you found the secret spot! ‚ú®';
                const randomCard = [msg1, msg2, msg3][Math.floor(Math.random() * 3)];
                randomCard.innerText = getOrganicMessage();
            });

            const loveRiver = document.getElementById('loveRiver');
            const riverFill = document.getElementById('riverFill');
            const lovePercentEl = document.getElementById('lovePercent');
            const destinySilk = document.getElementById('destinySilk');
            let lovePercent = 64;

            function updateLoveMeter() {
                riverFill.style.width = lovePercent + '%';
                lovePercentEl.innerText = lovePercent + '%';
                if (lovePercent >= 100) {
                    riverFill.innerHTML = 'üíñüíñüíñ';
                    destinySilk.innerText = getOrganicMessage() + ' üí´ü©∑';
                } else riverFill.innerHTML = 'üíñ';
            }

            function addLove(amount, src) {
                lovePercent = Math.min(lovePercent + amount, 100);
                updateLoveMeter();
                burstFromElement(src);
            }

            loveRiver.addEventListener('click', function(e) {
                addLove(6, loveRiver);
            });

            const mysticYes = document.getElementById('mysticYesBtn');
            const mysticNo = document.getElementById('mysticNoBtn');

            mysticYes.addEventListener('click', function(e) {
                burstFromElement(mysticYes);
                destinySilk.innerText = getOrganicMessage() + ' üíò';
                lovePercent = 100;
                updateLoveMeter();
            });

            mysticNo.addEventListener('click', function(e) {
                burstFromElement(mysticNo);
                mysticNo.innerText = 'yes üíï';
                mysticNo.style.background = '#ffe9f2';
                setTimeout(() => { mysticNo.innerText = 'no üå™Ô∏è'; mysticNo.style.background = '#ffdae7'; }, 800);
                destinySilk.innerText = 'üòÇ no is not an option here, sweetheart üíã';
                addLove(18, mysticNo);
            });

            setInterval(() => {
                if (mysticRealm.classList.contains('realm-visible')) {
                    destinySilk.innerText = getOrganicMessage();
                }
            }, 7000);

            const locket = document.querySelector('.velvet-locket');
            locket.addEventListener('dblclick', function(e) {
                addLove(15, locket);
                destinySilk.innerText = 'ü¶ã double magic! ü¶ã';
            });

            mysticRealm.style.display = 'none';
        })();
    </script>
</body>
</html>
